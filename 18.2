import pandas as pd
import numpy as np

import seaborn as sns
import matplotlib.pyplot as plt

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression, Ridge, RidgeCV, Lasso, LassoCV
import math as ma

df = pd.read_csv("sgn.csv")
X = df["x"]
y = df["y"]


for m in 1,5,20,100,1000:
  a = np.column_stack([X.apply(lambda x: ma.cos(x*i)) for i in range(m)]) # lambda - анонимная функция, возвращает результат
  b = np.column_stack([X.apply(lambda x: ma.sin(x*i)) for i in range(m)])
  w = np.hstack([a, b]) #соединили массивы по горизонтали
  
  model = LinearRegression()
  model.fit(w, y)
  print("коэффициент при х", model.coef_)
  print('свободный член', model.intercept_)
  if m == 1:
    sns.scatterplot(x=X, y=y)
    y_pred = model.predict(w)
    sns.lineplot(x=X, y=y_pred)
    plt.tight_layout()
    plt.savefig("test1.pdf")
  elif m == 5:
    sns.scatterplot(x=X, y=y)
    y_pred = model.predict(w)
    sns.lineplot(x=X, y=y_pred)
    plt.tight_layout()
    plt.savefig("test5.pdf")
  elif m == 20:
    sns.scatterplot(x=X, y=y)
    y_pred = model.predict(w)
    sns.lineplot(x=X, y=y_pred)
    plt.tight_layout()
    plt.savefig("test20.pdf")
  elif m == 100:
    sns.scatterplot(x=X, y=y)
    y_pred = model.predict(w)
    sns.lineplot(x=X, y=y_pred)
    plt.tight_layout()
    plt.savefig("test100.pdf")
  elif m == 1000:
    sns.scatterplot(x=X, y=y)
    y_pred = model.predict(w)
    sns.lineplot(x=X, y=y_pred)
    plt.tight_layout()
    plt.savefig("test1000.pdf")

коэффициент при х [0. 0.]
свободный член -0.0044526341156887386
коэффициент при х [ 0.00000000e+00  1.52178093e-03  1.22063343e-03 -6.30254496e-03
 -3.55254045e-03 -1.11022302e-16  1.26491679e+00  2.62664126e-04
  4.25026998e-01 -3.80589168e-03]
свободный член -0.0044550829726978875
коэффициент при х [ 1.06019504e-17  1.51960368e-03  1.22281068e-03 -6.30472221e-03
 -3.55036320e-03 -1.52232940e-03  5.58500591e-03 -3.14677254e-03
 -3.11458526e-03 -2.10464447e-03 -7.38384380e-03 -6.79876058e-03
 -4.51711338e-03  2.24280340e-03 -1.90063554e-05  5.00275777e-04
 -3.50720056e-04  4.42972516e-03 -1.78771835e-03 -4.09094551e-03
 -8.32667268e-17  1.26491679e+00  2.62664126e-04  4.25026998e-01
 -3.80589168e-03  2.57432965e-01  2.58057807e-03  1.89023306e-01
 -1.67366696e-03  1.40173314e-01  1.75548209e-03  1.22313698e-01
 -5.76361021e-03  1.00734791e-01 -5.63318179e-03  8.44272410e-02
  6.99321870e-03  7.45034555e-02  2.73854030e-03  7.41500351e-02]
свободный член -0.004453994348576724
коэффициент при х [ 8.74324964e-20  1.56193651e-03  1.18047785e-03 -6.26238939e-03
 -3.59269603e-03 -1.47999658e-03  5.54267308e-03 -3.10443972e-03
 -3.15691808e-03 -2.06231165e-03 -7.42617662e-03 -6.75642776e-03
 -4.55944620e-03  2.28513623e-03 -6.13391805e-05  5.42608602e-04
 -3.93052881e-04  4.47205799e-03 -1.83005117e-03 -4.04861268e-03
  3.61152442e-03 -3.69141417e-03  5.30356106e-03  3.30977067e-04
  2.59240938e-03 -5.33953506e-04 -6.23019123e-03 -2.44900409e-03
  1.48125362e-03 -2.09693121e-03 -6.96300028e-03 -3.38867463e-03
 -3.81008284e-03  6.84101897e-03 -6.70758259e-03  5.49514078e-03
 -2.92762968e-03 -6.67739080e-03 -4.30746038e-03 -7.86161458e-04
  6.13232670e-03  4.70885312e-04  6.26244574e-04 -3.05219575e-03
  8.83693358e-04  1.16992827e-03  1.69069670e-03 -1.40208276e-03
 -1.70650492e-03  1.15005307e-03  4.30951565e-03  5.71938761e-03
  3.96498488e-03  4.32526556e-03 -3.01894883e-03  3.69579961e-04
 -3.79275616e-03  1.06323405e-03 -2.27158375e-03 -4.88801863e-03
  4.48625652e-03  5.52122283e-04 -4.80680087e-03 -3.98069403e-03
 -1.51974165e-03  7.30273461e-03 -3.07168514e-03 -5.78858746e-03
 -2.03639618e-03 -4.95520028e-03 -3.73285482e-03  1.40406965e-03
  1.84431072e-03  5.23922774e-04  3.19328733e-03 -1.59422342e-03
  2.45255433e-03 -4.00931195e-03  6.72671888e-03 -4.92119153e-03
  1.04482581e-03  2.37359377e-03 -1.16471195e-04  2.04121457e-03
  8.98403605e-04 -5.87811255e-03 -5.63224560e-03  3.72401787e-03
  7.15973001e-03  4.73558712e-03 -7.53793302e-03 -4.37973833e-03
 -4.48360381e-04 -5.30694199e-03  1.68764966e-03  2.77375160e-03
 -1.31821624e-03 -5.45949548e-03  9.91118523e-03 -1.05321042e-03
  1.38777878e-17  1.26491679e+00  2.62664126e-04  4.25026998e-01
 -3.80589168e-03  2.57432965e-01  2.58057807e-03  1.89023306e-01
 -1.67366696e-03  1.40173314e-01  1.75548209e-03  1.22313698e-01
 -5.76361021e-03  1.00734791e-01 -5.63318179e-03  8.44272410e-02
  6.99321870e-03  7.45034555e-02  2.73854030e-03  7.41500351e-02
  1.78243134e-03  5.97305614e-02 -7.33635872e-04  5.42002192e-02
  8.48652976e-04  5.38799453e-02 -5.41591004e-03  4.78979239e-02
 -7.44505683e-03  4.78178400e-02  3.11971358e-03  3.65749796e-02
 -3.09895773e-03  2.56123514e-02  5.77961526e-03  4.10314775e-02
  1.82926050e-03  2.98940546e-02 -5.05607927e-03  3.45416186e-02
 -7.59780838e-04  2.61398999e-02 -1.34715610e-02  2.37407309e-02
 -2.06709456e-05  3.32122636e-02  2.28916215e-03  2.73888731e-02
  1.15466003e-03  2.71403748e-02 -6.99583667e-04  2.09079774e-02
  4.79914556e-03  2.13631015e-02  7.40397393e-03  1.79822839e-02
  1.97321152e-03  2.33092633e-02 -6.05242241e-03  1.97015405e-02
  1.93528939e-04  2.23935501e-02  3.98161974e-03  2.40496884e-02
 -4.93023358e-03  1.62873709e-02  5.35403628e-03  1.62833674e-02
  2.26094147e-03  1.39252160e-02 -7.91658547e-03  2.25597405e-02
 -4.89685668e-03  1.35112087e-02  1.56948606e-03  1.98734220e-02
 -5.30314695e-03  2.25752762e-02  6.77727262e-03  1.88507837e-02
 -3.92364513e-03  1.77482114e-02 -7.15534864e-03  1.60417504e-02
 -4.64063830e-03  1.24197014e-02 -1.06841585e-02  1.79582113e-02
 -1.26439957e-03  1.55575363e-02  4.33914920e-03  1.59760898e-02
  3.27155886e-03  2.26600892e-02 -6.15965681e-03  9.16759913e-03
 -6.82650389e-03  1.05641207e-02  4.79439723e-03  8.32464357e-03]
свободный член -0.004475160761158769
коэффициент при х [-1.16575542e+07 -1.41652755e+08 -2.37525892e+08 ...  2.14920184e+09
 -2.97815028e+09  7.80016561e+09]
свободный член 11657554.21679178
